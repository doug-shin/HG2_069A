# 배터리 충방전 모듈 CAN 통신 프로토콜 (v1.98)



## 문서 정보
- **문서명**: E2M_ADT_CANDB
- **리비전**: Rev v1.98 (2024-07-10, Initial Release)
- **작성자**: pk (Engineer)



## 통신 사양
- **통신 방식**: CAN
- **Baudrate**: 500kbps
- **데이터 길이**: 모든 메시지 8바이트



## CAN ID 체계 개요


### 모듈 → EPC 통신
| ID 범위  | 용도        | 주기   |
|:--------|:-----------|:------|
| 100번대  | 동작 중 보고  | 10ms  |
| 110번대  | 대기 중 보고  | 100ms |
| 130번대  | 동작 종료 보고 | -     |
| 2200번대 | 명령 응답 확인 | -     |


### EPC → 모듈 통신
| ID 범위 | 용도          | 비고      |
|:-------|:-------------|:---------|
| 200번대 | 스케줄 명령     | -        |
| 210번  | 제어 명령       | -        |
| 250번대 | 글로벌 안전 조건 | 옵션      |
| 260번대 | 패턴 데이터     | 추후 구현  |
| 360번  | Heart Bit    | 100ms 주기 |


### CAN ID 구조
예시: 0xXXYYYY (XX: 채널번호)
100번대: Module => EPC
200번대: EPC => Module (Module은 2000번대로 ACK함)


#### 설명
빅엔디안을 사용할꺼야. 우리가 짜는건 모듈용 프로그램이야. 전류 단위는 ma, 전압은 mv, 시간단위는 10ms, 온도단위는 0.1도C야. 
에러 및 경고 코드, 알람 및 이벤트 코드, 패턴 명령, 주기적 확인신호는 나중에 구현할꺼야.
기본 동작 순서는 200번대 명령id가 오면 조건을 저장한뒤(통합 데이터 구조체에 저장) 매번 Ack 해주고 210번 제어명령이 오면 제어에 들어가.
작동 중에는 100번대로 10ms 보고(8개 id니까 총 80ms 사이클)하고 작동 중이 아닐 때는 110번대로 100ms 보고(800ms 사이클)로 보고하는 거야. 
200번대에서 동작 조건이 주어지고 210 제어명령에서 시작하라고 하면 작동 상태로 들어가고 100번대 보고로 들어가면 되겠지.
안전조건 미충족시 일시정지하고 종료조건 충족시 정지해. 혹은 210 제어명령에서 일시정지, 정지 명령이 와도 작동을 종료하게 되겠지. 이렇게 작동이 정지, 일시정지 등을 하게 될 때는 130번대로 종료 보고를 해야해. 그 뒤에는 110번대로 100ms 보고를 하는거야.


## 상세 메시지 구조


### 1. 100번대 (동작 중 보고, 모듈 → EPC, 10ms)

#### 0xXX0100 - 작업 스케줄 동작후 10ms Online Data #1
| Byte | 내용          | 설명                                                                                                |
|:-----|:-------------|:---------------------------------------------------------------------------------------------------|
| 0    | 채널 번호      | -                                                                                                  |
| 1-2  | 스탭 번호      | 0 ~ 65,535                                                                                         |
| 3    | 동작 상태      | 0: 준비 / 1: 운전 / 2: 경알람 / 3: 알람 / 4: 비상정지 / 5: 일시정지 / 6: 종료                                 |
| 4    | 운전 모드      | 0: 대기 / 1: CC / 2: CV / 3: CC/CV / 4: CP/CV / 5: Pattern / 6: Rest / 10: PWR Start / 50: PWR Stop |
| 5    | 상태 비트      | Bit 7: PWR ON/OFF / Bit 1: 출력 릴레이 ON/OFF / Bit 0: 병렬 ON/OFF                                     |
| 6-7  | 알람/이벤트 코드 | 0 ~ 65,535                                                                                         |

#### 0xXX0101 - 작업 스케줄 동작후 10ms Online Data #2
| Byte | 내용    | 설명                         |
|:-----|:-------|:----------------------------|
| 0-1  | T1 온도 | -32,768 ~ 32,767 (x10 스케일) |
| 2-3  | T2 온도 | -32,768 ~ 32,767 (x10 스케일) |
| 4-7  | 전압    | float (V)                   |

#### 0xXX0102 - 작업 스케줄 동작후 10ms Online Data #3
| Byte | 내용    | 설명                          |
|:-----|:-------|:-----------------------------|
| 0-3  | 전류    | float (A), 충전(+)/방전(-)     |
| 4-7  | CV 타임 | 0 ~ 4,294,967,295 (1 = 10ms) |

#### 0xXX0103 - 작업 스케줄 동작후 10ms Online Data #4
| Byte | 내용    | 설명   |
|:-----|:-------|:------|
| 0-3  | 충전 Ah | float |
| 4-7  | 방전 Ah | float |

#### 0xXX0104 - 작업 스케줄 동작후 10ms Online Data #5
| Byte | 내용    | 설명    |
|:-----|:------|:------|
| 0-3  | 충전 Wh | float |
| 4-7  | 방전 Wh | float |

#### 0xXX0105 - 작업 스케줄 동작후 10ms Online Data #6
| Byte | 내용      | 설명                          |
|:-----|:---------|:-----------------------------|
| 0-3  | 운전 시간  | 0 ~ 4,294,967,295 (1 = 10ms) |
| 4-7  | Reserved | -                            |

#### 0xXX0106 - 작업 스케줄 동작후 10ms Online Data #7
| Byte    | 내용                  | 설명              |
|:--------|:---------------------|:-----------------|
| 0-1     | PWM Hardware Error   | 에러/주의코드 참조   |
| 2-3     | PWM Software Error 1 | 에러/주의코드 참조   |
| 4-5     | PWM Software Error 2 | 에러/주의코드 참조   |
| 6-7     | PWM Software Warning | 에러/주의코드 참조   |

#### 0xXX0107 - 작업 스케줄 동작후 10ms Online Data #8
| Byte    | 내용                    | 설명              |
|:--------|:-----------------------|:-----------------|
| 0-1     | DC/DC Hardware Error   | 에러/주의코드 참조   |
| 2-3     | DC/DC Software Error 1 | 에러/주의코드 참조   |
| 4-5     | DC/DC Software Error 2 | 에러/주의코드 참조   |
| 6-7     | DC/DC Software Warning | 에러/주의코드 참조   |


### 2. 110번대 (대기 중 보고, 모듈 → EPC, 100ms)
- 110~115: 0xXX0100 ~ 0xXX0105와 동일
- 116~117: 0xXX0106 ~ 0xXX0107와 동일


### 3. 130번대 (종료 시 보고, 모듈 → EPC, 스텝 종료 시 혹은 안전조건, 종료조건, 정지명령, 일시정지명령, 기타 등등에 의한 종료 시)

#### 0xXX0130 - Step End Data #1
| Byte | 내용              | 설명                        |
|:-----|:-----------------|:---------------------------|
| 0    | 채널 번호          | -                          |
| 1-2  | 스탭 번호          | 0 ~ 65,535                 |
| 3    | 동작 상태          | 0xXX0100 #3과 동일           |
| 4    | 운전 모드          | 0xXX0100 #4와 동일           |
| 5-6  | 알람/이벤트 코드     | Alarm_Event Code 시트 참조   |
| 7    | Pattern Index No | Pattern 모드 시 진행 중 Index |

#### 0xXX0131 - Step End Data #2
| Byte | 내용    | 설명                         |
|:-----|:-------|:----------------------------|
| 0-1  | T1 온도 | -32,768 ~ 32,767 (x10 스케일) |
| 2-3  | T2 온도 | -32,768 ~ 32,767 (x10 스케일) |
| 4-7  | 전압    | float (V)                   |

#### 0xXX0132 - Step End Data #3
| Byte | 내용    | 설명                          |
|:-----|:-------|:-----------------------------|
| 0-3  | 전류    | float (A), 충전(+)/방전(-)     |
| 4-7  | CV 타임 | 0 ~ 4,294,967,295 (1 = 10ms) |

#### 0xXX0133 - Step End Data #4
| Byte | 내용    | 설명   |
|:-----|:-------|:------|
| 0-3  | 충전 Ah | float |
| 4-7  | 방전 Ah | float |

#### 0xXX0134 - Step End Data #5
| Byte | 내용    | 설명    |
|:-----|:-------|:-------|
| 0-3  | 충전 Wh | float  |
| 4-7  | 방전 Wh | float  |

#### 0xXX0135 - Step End Data #6
| Byte | 내용           | 설명                           |
|:-----|:--------------|:------------------------------|
| 0-3  | 운전 시간       | 0 ~ 4,294,967,295 (1 = 10ms)  |
| 4-7  | Pattern Index | Pattern 모드 시 진행 중 Index    |


### 4. 2200번대 (명령 확인응답, 모듈 → EPC)

#### 2200번대, 2250번대, 2260번대
| Byte | 내용                  | 설명                                          |
|:-----|:---------------------|:---------------------------------------------|
| 0-7  | Bypass               | Ack                                          |

#### 0xXX2210 - Control Command Ack
| Byte | 내용                  | 설명                                          |
|:-----|:---------------------|:---------------------------------------------|
| 0    | 채널 번호              | -                                            |
| 1    | Receive Command Code | 0xXX0210 #1 Bypass                           |
| 2-3  | Receive Event Code   | 0xXX0210 #2-3 Bypass                         |
| 4    | Response ACK         | 0xXX01: OK / 0xXXFF: NG (NG 시 이벤트 코드 적용) |
| 5    | Event Code           | Alarm_Event Code 시트 참조                     |
| 6-7  | Reserved             | -                                            |


### 5. 200번대 (스텝 명령, EPC → 모듈, 스텝 시작 시마다 전송)

#### 0xXX0201 - 스텝 명령 #1
| Byte | 내용     | 설명                      |
|:-----|:--------|:-------------------------|
| 0    | 채널 번호 | -                        |
| 1-2  | 스탭 번호 | 0 ~ 65,535               |
| 3    | 운전 모드 | 0xXX0100 #4와 동일         |
| 4-7  | 전류     | float (A), 충전(+)/방전(-) |

#### 0xXX0202 - 스텝 명령 #2
| Byte | 내용 | 설명       |
|:-----|:----|:----------|
| 0-3  | 전압 | float (V) |
| 4-7  | 파워 | float (W) |

#### 0xXX0203 - 스텝 명령 #3
| Byte | 내용    | 설명                           |
|:-----|:-------|:------------------------------|
| 0-3  | 시작 시간 | 0 ~ 4,294,967,295 (1 = 10ms) |
| 4-7  | 운전 시간 | 0 ~ 4,294,967,295 (1 = 10ms) |

#### 0xXX0204 - 스텝 명령 #4
| Byte | 내용              | 설명                                  |
|:-----|:-----------------|:-------------------------------------|
| 0-3  | Wh 종료 조건       | float, Pattern 모드 시 충전/방전 합산 종료 |
| 4-7  | Ah 종료 조건       | float, Pattern 모드 시 충전/방전 합산 종료 |

#### 0xXX0205 - 스텝 명령 #5
| Byte | 내용              | 설명                |
|:-----|:-----------------|:-------------------|
| 0-3  | 전압 종료 조건      | float (V)          |
| 4-7  | 전류 종료 조건      | float (A)          |

#### 0xXX0206 - 스텝 명령 #6
| Byte | 내용                   | 설명                                            |
|:-----|:----------------------|:-----------------------------------------------|
| 0-3  | CV 타임 종료 조건        | 0 ~ 4,294,967,295 (1 = 10ms), CV 구간 유지 시 종료 |
| 4-7  | 전압 안전 조건 Min       | float (V)                                      |

#### 0xXX0207 - 스텝 명령 #7
| Byte | 내용                   | 설명        |
|:-----|:----------------------|:-----------|
| 0-3  | 전압 안전 조건 Max       | float (V)  |
| 4-7  | 충전 전류 안전 조건       | float (A)  |

#### 0xXX0208 - 스텝 명령 #8
| Byte | 내용                   | 설명        |
|:-----|:----------------------|:-----------|
| 0-3  | 방전 전류 안전 조건       | float (A)  |
| 4-7  | 충전 용량 안전 조건       | float (Ah) |

#### 0xXX0209 - 스텝 명령 #9
| Byte | 내용                   | 설명        |
|:-----|:----------------------|:-----------|
| 0-3  | 방전 용량 안전 조건       | float (Ah) |
| 4-7  | Reserved             | -          |


### 6. 210번대 (제어 명령, EPC → 모듈, 200번대 전송 후 전송해서 스텝 시작)

#### 0xXX0210 - Control Command
| Byte | 내용          | 설명                                                                                                                  |
|:-----|:-------------|:---------------------------------------------------------------------------------------------------------------------|
| 0    | 채널 번호      | -                                                                                                                    |
| 1    | Command Code | 0xXX01: 시작 / 0xXX02: 정지 / 0xXX03: 일시정지 / 0xXX0A: PWR Start / 0xXX32: PWR Stop / 0xXX0B: 알람 리셋 / 0xXXD1: 비상정지 |
| 2-3  | Event Code   | 정지 및 비상정지 시 사유 (Alarm_Event Code E 코드 참조)                                                                     |
| 4-7  | Reserved     | -                                                                                                                   |



### 7. 250번대 (글로벌 안전 조건, EPC → 모듈, 스케줄 명령 시 최초 1회 전송)

#### 0xXX0250 - Global Safety #1
| Byte | 내용         | 설명   |
|:-----|:------------|:------|
| 0-3  | 전류 (A) Max | float |
| 4-7  | 전압 (V) Min | float |

#### 0xXX0251 - Global Safety #2
| Byte | 내용         | 설명   |
|:-----|:------------|:------|
| 0-3  | 전압 (V) Max | float |
| 4-7  | Reserved    | -     |

#### 0xXX0252 - Global Safety #3
| Byte | 내용           | 설명   |
|:-----|:--------------|:------|
| 0-3  | 용량 (Ah) Max  | float |
| 4-7  | 전력량 (Wh) Max | float |

#### 0xXX0253 - Global Safety #4
| Byte | 내용      | 설명               |
|:-----|:---------|:------------------|
| 0-1  | Δ전압     | 0 ~ 65,535 (mV)   |
| 2-3  | Δ전압 시간 | 0 ~ 65,535 (ms)   |
| 4-5  | Δ전류     | 0 ~ 65,535 (mA)   |
| 6-7  | Δ전류 시간 | 0 ~ 65,535 (ms)   |

#### 0xXX0254 - Global Safety #5
| Byte | 내용         | 설명     |
|:-----|:------------|:--------|
| 0-3  | 전류 (A) Min | float   |
| 4-7  | Reserved    | -       |


### 8. 260번대 (패턴 명령, EPC → 모듈)

#### 0xXX0260 - Pattern Data #1
| Byte | 내용              | 설명                                                    |
|:-----|:-----------------|:-------------------------------------------------------|
| 0    | 채널 번호          | -                                                      |
| 1    | Pattern Data 형태 | 1: 시작 전 저장 (최대 100개) / 2: 요청 데이터 / 3: 마지막 데이터  |
| 2    | 제어 Type         | 1: 전류 / 2: Power                                      |
| 3-4  | 패턴 단위 시간      | ms                                                     |
| 5-7  | Reserved         | -                                                      |

#### 0xXX0261 - Pattern Data #2
| Byte | 내용           | 설명               |
|:-----|:--------------|:------------------|
| 0-3  | Pattern Index | 0 ~ 4,294,967,295 |
| 4-7  | 전류/Power     | float (A 또는 W)   |


### 9. 360번 (주기적 확인신호, EPC → 모듈)

#### 0xXX0360 - Heart Bit 100ms
| Byte | 내용      | 설명                                 |
|:-----|:---------|:------------------------------------|
| 0    | 카운트     | 1 ~ 100 (1초 미수신 시 모듈 정지 및 알람) |
| 1-7  | Reserved | -                                   |



## 주의사항
1. 시간단위: 10ms, 전압단위 : 0.001V, 전류단위: 0.001A, 온도단위 0.1°C
2. Heart Bit (0xXX0360)는 1초 이상 미수신 시 모듈이 정지되고 알람이 발생합니다.
3. 부동소수점(float) 데이터는 IEEE-754 표준을 따릅니다.



## 에러 및 경고 코드


### PWM 컨버터 에러 및 경고 (0xXX0106, 0xXX0116)
설명: PWM 컨버터의 하드웨어/소프트웨어 에러 및 경고 상태를 보고합니다.

#### PWM Converter Hardware Error (Data #0-1)
| 코드    | 내용        | 설명                           |
|:-------|:-----------|:------------------------------|
| 0x0001 | 입력 a상 전류 | a상 Peak 전류가 30A 이상 발생      |
| 0x0002 | 입력 b상 전류 | b상 Peak 전류가 30A 이상 발생      |
| 0x0004 | 입력 c상 전류 | c상 Peak 전류가 30A 이상 발생      |
| 0x0008 | 출력 과전류   | 출력 Idc 전류가 20A 이상 발생      |

#### PWM Converter Software Error 1 (Data #2-3)
| 코드    | 내용           | 설명                           |
|:-------|:--------------|:------------------------------|
| 0x0001 | abc rms 전압   | abc rms 전압이 90% 이하로 감지됨    |
| 0x0002 | abc 전압 순번   | 전압 상(Phase) 순서 불일치         |
| 0x0004 | 초충 저항       | 초기 충전 저항 문제 발생            |
| 0x0010 | Vdc 저전압     | 입력전압 230V 이하 감지           |
| 0x0020 | Vdc 과전압     | 입력전압 420V 이상 감지           |
| 0x0040 | Vab rms 저전압 | Vas rms 전압 140V 이하 감지      |
| 0x0080 | Vab rms 과전압 | Vas rms 전압 240V 이상 감지      |
| 0x0100 | Vbc rms 저전압 | Vbs rms 전압 140V 이하 감지      |
| 0x0200 | Vbc rms 과전압 | Vbs rms 전압 240V 이상 감지      |
| 0x0400 | Vca rms 저전압 | Vcs rms 전압 140V 이하 감지      |
| 0x0800 | Vca rms 과전압 | Vcs rms 전압 240V 이상 감지      |
| 0x1000 | Ias 과전류     | Ias 전류 ±25A 이상 감지          |
| 0x2000 | Ibs 과전류     | Ibs 전류 ±25A 이상 감지          |
| 0x4000 | Ics 과전류     | Ics 전류 ±25A 이상 감지          |
| 0x8000 | Idc 과전류     | Idc 전류 ±20A 이상 감지          |

#### PWM Converter Software Error 2 (Data #4-5)
| 코드    | 내용        | 설명                           |
|:-------|:-----------|:------------------------------|
| 0x0001 | 보드 온도     | 보드 온도 80℃ 이상 감지            |
| 0x0002 | IPM_NTC 온도 | IPM_NTC 온도 80℃ 이상 감지        |
| 0x0004 | IPM_TSO 온도 | IPM_TSO 온도 80℃ 이상 감지        |
| 0x0010 | 후방팬1      | 후방팬1 10초 이상 동작 이상         |
| 0x0020 | 후방팬2      | 후방팬2 10초 이상 동작 이상         |
| 0x0040 | 후방팬3      | 후방팬3 10초 이상 동작 이상         |
| 0x0080 | 후방팬4      | 후방팬4 10초 이상 동작 이상         |

#### PWM Converter Software Warning (Data #6-7)
| 코드    | 내용        | 설명                           |
|:-------|:-----------|:------------------------------|
| 0x0001 | 보드 온도     | 보드 온도 75℃ 이상 감지            |
| 0x0002 | IPM_NTC 온도 | IPM_NTC 온도 75℃ 이상 감지        |
| 0x0004 | IPM_TSO 온도 | IPM_TSO 온도 75℃ 이상 감지        |
| 0x0010 | 후방팬1      | 후방팬1 3초 이상 동작 이상          |
| 0x0020 | 후방팬2      | 후방팬2 3초 이상 동작 이상          |
| 0x0040 | 후방팬3      | 후방팬3 3초 이상 동작 이상          |
| 0x0080 | 후방팬4      | 후방팬4 3초 이상 동작 이상          |


### DC/DC 컨버터 에러 및 경고 (0xXX0107, 0xXX0117)
설명: DC/DC 컨버터의 하드웨어/소프트웨어 에러 및 경고 상태를 보고합니다.

#### DC/DC Converter Hardware Error (Data #0-1)
| 코드    | 내용       | 설명                           |
|:-------|:----------|:------------------------------|
| 0x0001 | Idc 과전류  | Idc 전류 ±20A 이상 감지          |

#### DC/DC Converter Software Error 1 (Data #2-3)
| 코드    | 내용       | 설명                           |
|:-------|:----------|:------------------------------|
| 0x0010 | Vdc 저전압  | 입력전압 230V 이하 감지            |
| 0x0020 | Vdc 과전압  | 입력전압 420V 이상 감지            |
| 0x0040 | Idc 과전류  | Idc 전류 ±15A 이상 감지           |
| 0x0200 | 배터리 과전압 | 배터리 전압 4.35V 이상 감지         |
| 0x0400 | 배터리 과전류 | 배터리 전류 ±360A 이상 감지         |
| 0x0800 | 배터리 역전압 | 배터리 전압 -0.5V 이하 감지         |
| 0x8000 | EPC 통신   | EPC 체크데이터 1초 이상 미수신        |

#### DC/DC Converter Software Error 2 (Data #4-5)
| 코드    | 내용     | 설명                           |
|:-------|:--------|:------------------------------|
| 0x0001 | 보드 온도  | 보드 온도 80℃ 이상 감지             |
| 0x0002 | CAP 온도 | CAP 온도 80℃ 이상 감지             |

#### DC/DC Converter Software Warning (Data #6-7)
| 코드    | 내용     | 설명                             |
|:-------|:--------|:--------------------------------|
| 0x0001 | 보드 온도  | 보드 온도 75℃ 이상 감지             |
| 0x0002 | CAP 온도 | CAP 온도 75℃ 이상 감지              |


## 알람 및 이벤트 코드 (0xXX0100, 0xXX0110, 0xXX0130)
설명: 모듈의 동작 상태, 종료 조건, 안전 조건 등과 관련된 알람 및 이벤트를 보고합니다.

| 코드    | 이름                   | 타입   | 설명                         | 비고      |
|:-------|:----------------------|:------|:---------------------------|:---------|
| 0xE001 | 수동 정지               | Event | 수동 작업 종료                 | EPC 명령  |
| 0xE002 | 일시 정지               | Event | 작업 일시 정지                 | EPC 명령  |
| 0xE003 | 종료 챔버               | Event | 챔버 안전 조건 종료             | EPC 명령  |
| 0xE004 | 종료 T1                | Event | 온도 T1 종료                  | EPC 명령  |
| 0xE005 | 종료 T2                | Event | 온도 T2 종료                  | EPC 명령  |
| 0xE006 | 종료전압 H              | Event | 전압 High 종료                | 충전조건   |
| 0xE007 | 종료전압 L              | Event | 전압 Low 종료                 | 방전조건   |
| 0xE008 | 종료전류                | Event | 전류 종료                     | -        |
| 0xE009 | 종료 시간               | Event | 시간 종료                     | -        |
| 0xE00A | 종료 용량               | Event | 용량 종료                     | -        |
| 0xE00B | 종료 전력량              | Event | 전력량 종료                   | -        |
| 0xE00C | 종료 파워               | Event | 파워 종료                     | -        |
| 0xE00D | 종료 CV 시간            | Event | CV 시간 종료                  | -        |
| 0xE00E | 종료 Cycle 반복횟수      | Event | Cycle 횟수 종료               | EPC 명령  |
| 0xE00F | STEP 안전 조건 전압 H    | Alarm | 전압 High 일시 정지            | 충전조건   |
| 0xE010 | STEP 안전 조건 전압 L    | Alarm | 전압 Low 일시 정지             | 방전조건   |
| 0xE011 | STEP 안전 조건 전류 H    | Alarm | 전류 High 일시 정지            | 충전조건   |
| 0xE012 | STEP 안전 조건 전류 L    | Alarm | 전류 Low 일시 정지             | 방전조건   |
| 0xE013 | STEP 안전 용량 H        | Alarm | 용량 High 일시 정지            | 충전조건   |
| 0xE014 | STEP 안전 용량 L        | Alarm | 용량 Low 일시 정지             | 방전조건   |
| 0xE015 | Global 안전 조건 전압 H  | Alarm | 전압 High 일시 정지            | 충전조건   |
| 0xE016 | Global 안전 조건 전압 L  | Alarm | 전압 Low 일시 정지             | 방전조건   |
| 0xE017 | Global 안전 조건 전류 H  | Alarm | 전류 High 일시 정지            | 충전조건   |
| 0xE018 | Global 안전 조건 전류 L  | Alarm | 전류 Low 일시 정지             | 방전조건   |
| 0xE019 | Global 안전 용량 H     | Alarm | 용량 High 일시 정지             | 충전조건   |
| 0xE01A | Global 안전 용량 L     | Alarm | 용량 Low 일시 정지              | 방전조건   |
| 0xE01B | Global 최대 전력       | Alarm | 최대 전력 일시 정지              | -        |
| 0xE01C | Global 최대 전력량      | Alarm | 최대 전력량 일시 정지            | -        |
| 0xE01D | Global 안전 온도 H     | Alarm | Global 온도 High 일시 정지      | -        |
| 0xE01E | Global 안전 온도 L     | Alarm | Global 온도 Low 일시 정지       | -        |
| 0xE01F | STEP 안전 조건 온도 H   | Alarm | Step 온도 High 일시 정지        | -        |
| 0xE020 | STEP 안전 조건 온도 L   | Alarm | Step 온도 Low 일시 정지         | -        |
| 0xE021 | Global 안전 Delta V   | Alarm | Global Delta Voltage 일시 정지 | -        |
| 0xE022 | Global 안전 Delta A   | Alarm | Global Delta Current 일시 정지 | -        |
| 0xE023 | 종료 SOC              | Event | SOC 종료                      | -        |
| 0xE024 | 종료 DOD              | Event | DOD 종료                      | -        |
| 0xE025 | 종료 SOE              | Event | SOE 종료                      | -        |
| 0xE026 | 종료 DOE              | Event | DOE 종료                      | -        |
| 0xE030 | 종료 Pattern          | Event | Pattern 동작 종료              | -        |
| 0xE050 | 비상 정지              | Alarm | 비상 정지 스위치 동작             | EPC 명령  |
| 0xE051 | UPS 고장              | Alarm | UPS 고장                      | EPC 명령  |
| 0xE061 | 통신에러               | Event | GUI와 EPC간 통신 에러           | -        |
| 0xE062 | 통신에러               | Event | Power Module과 EPC간 통신 에러  | -        |
| 0xE071 | DIO 에러              | Alarm | DIO Input 에러                | -        |
| 0xE072 | DIO 에러              | Alarm | DIO Output 에러               | -        |
| 0xF001 | 파워모듈 시작 체크       | Alarm | 파워모듈 시작 실패                | -        |
| 0xF002 | 파워모듈 정지 체크       | Alarm | 파워모듈 정지 실패                | -        |

## 스케줄 스텝 시작 절차

### 정의
스텝은 한 단위의 제어절차이며 이 절차들을 모아놓은 것이 스케줄인 것으로 보인다.

### 절차

#### 스케줄 시작시 최초 1회 Global Safety Conditions 확인
EPC => Module  |  250 | Global Safety Conditions#1
Module => EPC  | 2250 | Ack
~
EPC => Module  |  254 | Global Safety Conditions#5
Module => EPC  | 2254 | Ack

### 각 스텝 시작 시
EPC => Module  |  201 | 스텝 명령 #1
Module => EPC  | 2201 | Ack
~
EPC => Module  |  209 | 스텝 명령 #9
Module => EPC  | 2209 | Ack

EPC => Module  |  210 | 제어 명령 (스텝 시작)
Module => EPC  | 2210 | Ack
